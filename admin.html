<!doctype html>
<html lang="de">
<head>
    <!-- build:ADMIN_EXPORT_NO_REFRESH_20251216_065009 -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>MyAuktion • Admin</title>
  <link rel="icon" type="image/x-icon" href="/static/my_icon.ico">
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body{min-height:100vh;background:linear-gradient(135deg,#0ea5e9,#1d4ed8 60%,#1e293b);color:#fff}
    .glass{background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.16);backdrop-filter:blur(12px)}
    .input{width:100%;padding:.55rem .8rem;border-radius:.8rem;border:1px solid rgba(255,255,255,.35);background:#fff;color:#000}
    .btn{padding:.55rem 1rem;border-radius:999px;font-weight:700}
    .btn-primary{background:#fff;color:#0f172a;box-shadow:0 8px 18px rgba(0,0,0,.2)}
    .badge{font-size:.72rem;padding:.2rem .55rem;border-radius:999px}
    .bad-red{background:rgba(239,68,68,.18);border:1px solid rgba(239,68,68,.5);color:#fecaca}
    .bad-green{background:rgba(34,197,94,.18);border:1px solid rgba(34,197,94,.5);color:#bbf7d0}
    .bad-yellow{background:rgba(250,204,21,.18);border:1px solid rgba(250,204,21,.55);color:#fde68a}
  </style>
</head>
<body>
<div class="max-w-6xl mx-auto px-4 py-6">
  <header class="flex items-center justify-between mb-6">
    <div>
      <div class="text-2xl font-extrabold">MyAuktion · Admin</div>
      <div class="text-xs opacity-80">Budget, Flags, Überblick & CSV</div>
    </div>
    <div class="flex gap-2">
      <a href="/" class="underline text-sm opacity-90">Zur Artikelaufnahme</a>
    </div>
  </header>

  <div id="locked" class="glass rounded-3xl p-6 shadow-xl hidden">
    <div class="text-lg font-bold mb-2">Admin geschützt</div>
    <p class="text-sm opacity-90 mb-2">Bitte Admin-Token eingeben, damit Budget & Admin-Flags sichtbar sind.</p>
    <div id="lock-error" class="text-xs hidden mb-2" style="color:#fecaca"></div>
    <div class="grid md:grid-cols-3 gap-3 items-end">
      <div class="md:col-span-2">
        <label class="text-xs opacity-80">Admin-Token</label>
        <input id="token" class="input" placeholder="Passwort eingeben…">
      </div>
      <button id="btn-unlock" class="btn btn-primary w-full">Freischalten</button>
    </div>
    <p class="text-xs opacity-70 mt-3">Token wird lokal im Browser gespeichert (localStorage).</p>
  </div>

  <div id="content" class="hidden">
    <section class="glass rounded-3xl p-5 shadow-xl mb-5">
      <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-3">
        <div>
          <div class="text-lg font-bold">CSV Export</div>
          <div class="text-xs opacity-80">Exportiere deine Artikel als Excel-kompatible CSV (mit Von/Bis Bereich).</div>
<div class="text-xs opacity-80 mt-2">Neu: Restore/Import (für Drive/Updates).</div>
        </div>
        <div class="glass rounded-2xl p-3 mb-3">
  <div class="text-sm font-semibold mb-2">CSV Export</div>
  <div class="grid grid-cols-1 sm:grid-cols-4 gap-2">
    <div>
      <label class="block text-xs opacity-80 mb-1">Von ArtikelNr</label>
      <input id="export-from" class="input" type="number" placeholder="z.B. 123458">
    </div>
    <div>
      <label class="block text-xs opacity-80 mb-1">Bis ArtikelNr</label>
      <input id="export-to" class="input" type="number" placeholder="z.B. 123480">
    </div>
    <div>
      <label class="block text-xs opacity-80 mb-1">Sortiment-ID</label>
      <input id="export-sortiment" class="input" type="number" placeholder="z.B. 2349">
    </div>
    <div class="flex items-end gap-2">
      <button id="btn-export-range" class="btn btn-primary w-full sm:w-auto" type="button">CSV exportieren</button>
      <button id="btn-export-images" class="btn btn-primary w-full sm:w-auto" type="button">Bilder ZIP</button>
    </div>
  </div>
  <div class="text-[11px] opacity-70 mt-2">Leer lassen = kompletter Export.</div>
  <div class="mt-3 grid grid-cols-1 sm:grid-cols-3 gap-2">
    <button id="btn-restore-now" class="btn btn-primary w-full sm:w-auto" type="button">Restore jetzt (Drive)</button>
    <label class="btn btn-primary w-full sm:w-auto" style="justify-content:center;cursor:pointer;">
      CSV importieren
      <input id="import-file" type="file" accept=".csv,text/csv" style="display:none">
    </label>
    <button id="btn-import-run" class="btn btn-primary w-full sm:w-auto" type="button">Import starten</button>
  </div>
  <div id="import-status" class="text-[11px] opacity-80 mt-2"></div>

</div>
      </div>
    </section>


    <section class="glass rounded-3xl p-5 shadow-xl mb-5">
      <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-3">
        <div>
          <div class="text-lg font-bold">Sortiment verwalten</div>
          <div class="text-xs opacity-80">Anlegen / umbennen / löschen – bleibt gespeichert und ist in den Einstellungen auswählbar.</div>
        </div>
        <div class="flex gap-2 w-full md:w-auto">
          <div class="grid grid-cols-1 md:grid-cols-3 gap-2 w-full md:w-auto"><input id="sort-add" class="input" placeholder="Name z.B. (22) Drogerie/Kosmetik 85"><input id="sort-add-id" class="input" placeholder="ID z.B. 2349 (leer = auto)"></div>
          <button id="btn-sort-add" class="btn btn-primary" type="button">Hinzufügen</button>
        </div>
      </div>
      <div id="sort-list" class="mt-3"></div>
    </section>
    <section class="glass rounded-3xl p-5 shadow-xl">
      <div class="flex flex-col md:flex-row md:items-end md:justify-between gap-3">
        <div>
          <div class="text-lg font-bold">Artikel</div>
          <div class="text-xs opacity-80">KI failed (rot), reviewed (grün), manuell (gelb)</div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-2 w-full md:w-auto">
          <div>
            <label class="text-xs opacity-80">Sortiment</label>
            <select id="f-sort" class="input">
              <option value="">Alle</option>
            </select>
          </div>
          <div>
            <label class="text-xs opacity-80">Nur KI-Fehler</label>
            <select id="f-failed" class="input">
              <option value="0" selected>Nein</option>
              <option value="1">Ja</option>
            </select>
          </div>
          <div>
            <label class="text-xs opacity-80">Suche</label>
            <input id="f-q" class="input" placeholder="ArtikelNr / Titel…">
          </div>
        </div>
      </div>

      <div class="overflow-x-auto mt-4">
        <table class="w-full text-sm">
          <thead class="text-left opacity-90">
            <tr>
              <th class="py-2 pr-3">Bild</th>
              <th class="py-2 pr-3">ArtikelNr</th>
              <th class="py-2 pr-3">Sortiment</th>
              <th class="py-2 pr-3">Bezeichnung</th>
              <th class="py-2 pr-3">Listenpreis</th>
              <th class="py-2 pr-3">Rufpreis</th>
              <th class="py-2 pr-3">Status</th>
              <th class="py-2 pr-3">Fehler</th>
            </tr>
          </thead>
          <tbody id="rows" class="align-top"></tbody>
        </table>
      </div>
    </section>
  </div>
</div>
    <section class="glass rounded-3xl p-5 shadow-xl mt-5">
      <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-3">
        <div>
          <div class="text-lg font-bold">KI Budget (geschätzt)</div>
          <div class="text-xs opacity-80">Extra geschützt: bitte Passwort erneut eingeben. Schätzung basiert auf erfolgreichen KI-Aufrufen (fixer €/Call). OpenAI-Hardlimit steuerst du im Dashboard.</div>
        </div>
      </div>

      <div id="budget-locked" class="glass rounded-2xl p-4 mt-4">
        <div class="text-sm font-semibold mb-2">Budget freischalten</div>
        <div class="grid md:grid-cols-3 gap-3 items-end">
          <div class="md:col-span-2">
            <label class="text-xs opacity-80">Budget-Passwort</label>
            <input id="budget-token" class="input" placeholder="Passwort erneut eingeben…">
          </div>
          <button id="btn-budget-unlock" class="btn btn-primary w-full">Budget anzeigen</button>
        </div>
      </div>

      <div id="budget-content" class="hidden">
        <div class="grid md:grid-cols-5 gap-3 mt-4">
          <div class="glass rounded-2xl p-3">
            <div class="text-xs opacity-80">Budget</div>
            <div id="b-budget" class="text-xl font-extrabold">–</div>
          </div>
          <div class="glass rounded-2xl p-3">
            <div class="text-xs opacity-80">Verbraucht</div>
            <div id="b-spent" class="text-xl font-extrabold">–</div>
          </div>
          <div class="glass rounded-2xl p-3">
            <div class="text-xs opacity-80">Rest</div>
            <div id="b-remaining" class="text-xl font-extrabold">–</div>
          </div>
          <div class="glass rounded-2xl p-3">
            <div class="text-xs opacity-80">KI Success</div>
            <div id="b-success" class="text-xl font-extrabold">–</div>
          </div>
          <div class="glass rounded-2xl p-3">
            <div class="text-xs opacity-80">KI Fail</div>
            <div id="b-fail" class="text-xl font-extrabold">–</div>
          </div>
        </div>

        <div class="text-xs opacity-80 mt-3">
          Letzter Fehler: <span id="b-lasterr" class="opacity-95">–</span>
        </div>
      </div>
    </section>


<script>
  const locked = document.getElementById('locked');
  const content = document.getElementById('content');
  const tokenInp = document.getElementById('token');
  const btnUnlock = document.getElementById('btn-unlock');

  const bBudget = document.getElementById('b-budget');
  const bSpent = document.getElementById('b-spent');
  const bRemaining = document.getElementById('b-remaining');
  const bSuccess = document.getElementById('b-success');
  const bFail = document.getElementById('b-fail');
  const bLastErr = document.getElementById('b-lasterr');

  const budgetLocked = document.getElementById('budget-locked');
  const budgetContent = document.getElementById('budget-content');
  const budgetTokenInp = document.getElementById('budget-token');
  const btnBudgetUnlock = document.getElementById('btn-budget-unlock');

  let budgetUnlocked = false;

  const rowsEl = document.getElementById('rows');
  const fSort = document.getElementById('f-sort');
  const fFailed = document.getElementById('f-failed');
  const fQ = document.getElementById('f-q');

function getToken(){
  // Safari/Privatmodus kann localStorage zicken -> zusätzlich Token per URL erlauben
  try{
    const qs = new URLSearchParams(location.search);
    const t = qs.get("t");
    if(t){
      localStorage.setItem("MYAUKTION_ADMIN_TOKEN", t);
      return t;
    }
    return localStorage.getItem("MYAUKTION_ADMIN_TOKEN") || "";
  }catch(e){
    // Fallback: nur URL
    const qs = new URLSearchParams(location.search);
    return qs.get("t") || "";
  }
}
function setToken(t){
  try{ localStorage.setItem("MYAUKTION_ADMIN_TOKEN", t); }catch(e){}
}

  async function api(path){
    const t = getToken();
    const res = await fetch(path, { headers: t ? {"X-Admin-Token": t} : {} });
    if(res.status === 401) throw new Error("unauthorized");
    return res.json();
  }

  function money(v){ return (Math.round(v*100)/100).toFixed(2).replace(".", ",") + " €"; }
  function badge(text, cls){ return `<span class="badge ${cls}">${text}</span>`; }

  function renderRows(items){
    const q = (fQ.value || "").trim().toLowerCase();
    const filtered = items.filter(it=>{
      if(!q) return true;
      return (String(it.artikelnr).toLowerCase().includes(q) || String(it.titel).toLowerCase().includes(q));
    });

    rowsEl.innerHTML = filtered.map(it=>{
      const img = it.image ? `<img src="${it.image}" style="height:54px;border-radius:12px;border:1px solid rgba(255,255,255,.25)">` : '';
      const st = [];
      if(it.reviewed) st.push(badge("reviewed","bad-green"));
      if(it.ki_source === "failed") st.push(badge("KI failed","bad-red"));
      if(it.ki_source === "realtime") st.push(badge("KI ok","bad-green"));
      if(!it.ki_source || it.ki_source === "pending") st.push(badge(it.ki_source === "pending" ? "pending" : "manuell","bad-yellow"));

      return `
        <tr class="border-t border-white/15">
          <td class="py-2 pr-3">${img}</td>
          <td class="py-2 pr-3 font-bold">${it.artikelnr}</td>
          <td class="py-2 pr-3">${it.sortiment || ""}</td>
          <td class="py-2 pr-3">${(it.titel||"").replaceAll("<","&lt;")}</td>
          <td class="py-2 pr-3">${money(Number(it.retail_price||0))}</td>
          <td class="py-2 pr-3">${money(Number(it.rufpreis||0))}</td>
          <td class="py-2 pr-3">${st.join(" ")}</td>
          <td class="py-2 pr-3 text-xs opacity-90">${(it.ki_last_error||"")}</td><td class=\"py-2 pr-3\"><a class=\"underline\" href=\"/?edit=${it.artikelnr}\">Bearbeiten</a></td>
        </tr>
      `;
    }).join("");
  }

  async function loadBudget(){
    const budget = await api("/api/admin/budget");
    bBudget.textContent = money(budget.budget_eur);
    bSpent.textContent = money(budget.spent_est_eur);
    bRemaining.textContent = money(budget.remaining_est_eur);
    bSuccess.textContent = String(budget.success_calls);
    bFail.textContent = String(budget.failed_calls);
    bLastErr.textContent = budget.last_error || "—";
  }


  async function loadSortimente(){
    try{
      const js = await api("/api/admin/sortimente");
      const items = (js.items||[]);
      if(fSort){
        const cur = (fSort.value || "").trim();
        fSort.innerHTML = '<option value="">Alle</option>' + items.map(it=>{
          const name = String(it.name ?? "").replaceAll('"','&quot;');
          return `<option value="${name}">${name}</option>`;
        }).join('');
        if(cur) fSort.value = cur;
      }
      // auch Management Liste
      renderSortimente(items);
    }catch(e){}
  }

  function renderSortimente(items){
    const box = document.getElementById('sort-list');
    if(!box) return;
    box.innerHTML = (items||[]).map(it=>{
      const id = String(it.id ?? "").replaceAll("<","&lt;").replaceAll('"','&quot;');
      const name = String(it.name ?? "").replaceAll("<","&lt;");
      return `
        <div class="flex items-center justify-between gap-2 py-1 border-b border-white/10">
          <div class="text-sm">
            <div class="font-semibold">${name}</div>
            <div class="text-xs opacity-80">ID: ${id}</div>
          </div>
          <div class="flex gap-2">
            <button class="btn btn-primary" style="padding:.25rem .7rem;font-size:.75rem" onclick="renameSortiment('${id}')">Umbenennen</button>
            <button class="btn btn-primary" style="padding:.25rem .7rem;font-size:.75rem" onclick="deleteSortiment('${id}')">Löschen</button>
          </div>
        </div>
      `;
    }).join('');
  }

  async function addSortiment(){
    const inp = document.getElementById('sort-add');
    const inpId = document.getElementById('sort-add-id');
    const name = (inp?.value || "").trim();
    const id = (inpId?.value || "").trim();
    if(!name) return;
    await apiPost("/api/admin/sortimente/add", {name, id});
    inp.value = "";
    if(inpId) inpId.value = "";
    await loadSortimente();
    await refresh();
  }

  async function renameSortiment(id){
    const js = await api("/api/admin/sortimente");
    const items = (js.items||[]);
    const cur = items.find(x => String(x.id) === String(id));
    const oldName = cur ? String(cur.name||"") : "";
    const nn = prompt("Neuer Name für Sortiment:", oldName);
    if(!nn) return;
    await apiPost("/api/admin/sortimente/rename", {id, new: nn});
    await loadSortimente();
    await refresh();
  }

  async function deleteSortiment(id){
    if(!confirm("Sortiment wirklich löschen?

ID: " + id)) return;
    await apiPost("/api/admin/sortimente/delete", {id});
    await loadSortimente();
    await refresh();
  }

  async function apiPost(path, data){
    const t = getToken();
    const res = await fetch(path, {
      method:'POST',
      headers: { 'Content-Type':'application/json', ...(t ? {'X-Admin-Token': t} : {}) },
      body: JSON.stringify(data||{})
    });
    if(res.status === 401) throw new Error("unauthorized");
    return res.json();
  }

  async function refresh(){
    const sortiment = (fSort.value || "").trim();
    const only_failed = fFailed.value || "0";
    const qs = new URLSearchParams();
    if(sortiment) qs.set("sortiment", sortiment);
    if(only_failed === "1") qs.set("only_failed", "1");

    const arts = await api("/api/admin/articles?" + qs.toString());
    renderRows(arts.items || []);

    if(budgetUnlocked){
      await loadBudget();
    }
  }


  async function init(){
    const t = getToken();
    if(!t){
      // Wenn Server kein ADMIN_TOKEN gesetzt hat, ist Admin offen -> ping testen
      try{
        const r = await fetch('/api/admin/ping');
        if(r.ok){
          locked.classList.add('hidden');
          content.classList.remove('hidden');
          await loadSortimente();
          await refresh();
          return;
        }
      }catch(e){}
      locked.classList.remove("hidden");
      content.classList.add("hidden");
      return;
    }
    try{
      locked.classList.add("hidden");
      content.classList.remove("hidden");

      // Budget extra-lock (pro Browser-Session)
      budgetUnlocked = (sessionStorage.getItem("MYAUKTION_BUDGET_UNLOCKED") === "1");
      if(budgetUnlocked){
        budgetLocked.classList.add("hidden");
        budgetContent.classList.remove("hidden");
      }else{
        budgetLocked.classList.remove("hidden");
        budgetContent.classList.add("hidden");
      }

      await loadSortimente();
      await refresh();
    }catch(e){
      // Token falsch oder Server nicht erreichbar
      try{
        const box = document.getElementById('lock-error');
        if(box){
          box.textContent = (String(e||'') === 'Error: unauthorized') ? 'Token falsch – bitte erneut eingeben.' : ('Fehler: ' + String(e));
          box.classList.remove('hidden');
        }
      }catch(_){}
      // falschen Token nicht „festklemmen“
      try{ localStorage.removeItem('MYAUKTION_ADMIN_TOKEN'); }catch(_){ }
      locked.classList.remove("hidden");
      content.classList.add("hidden");
    }
  }


  const btnSortAdd = document.getElementById('btn-sort-add');
  if(btnSortAdd){ btnSortAdd.onclick = addSortiment; }

  btnUnlock.onclick = async ()=>{
    try{ const box=document.getElementById('lock-error'); if(box){ box.classList.add('hidden'); box.textContent=''; } }catch(_){}

    const t = (tokenInp.value || "").trim();
    if(!t) return;
    setToken(t);
    await init();
  };

  if(btnBudgetUnlock){
    btnBudgetUnlock.onclick = async ()=>{
      const entered = (budgetTokenInp?.value || "").trim();
      let t = (getToken() || "").trim();

      if(!entered) return;

      // Wenn noch kein Admin-Token gespeichert ist (User hängt im Lock-Screen),
      // nehmen wir das eingegebene Passwort als Admin-Token und versuchen damit zu entsperren.
      if(!t){
        setToken(entered);
        t = entered;
      }

      // Wenn Token existiert, muss es übereinstimmen.
      if(t && entered !== t){
        alert("Falsches Passwort.");
        return;
      }

      // Budget freischalten
      sessionStorage.setItem("MYAUKTION_BUDGET_UNLOCKED", "1");
      budgetUnlocked = true;
      budgetLocked.classList.add("hidden");
      budgetContent.classList.remove("hidden");

      // WICHTIG: Budget-Button soll auch Admin entsperren (Content anzeigen)
      try{
        locked.classList.add("hidden");
        content.classList.remove("hidden");
      }catch(e){}

      await loadSortimente();
      await refresh();
    };
  }
fSort.onchange = refresh;
  fFailed.onchange = refresh;
  fQ.oninput = ()=> refresh();

  // CSV Export Bereich (Von/Bis)
  const btnExportRange = document.getElementById('btn-export-range');
  const exFrom = document.getElementById('export-from');
  const exTo = document.getElementById('export-to');
  const exSort = document.getElementById('export-sortiment');

  if(btnExportRange){
    btnExportRange.addEventListener('click', ()=>{
      const a = exFrom ? String(exFrom.value||'').trim() : '';
      const b = exTo ? String(exTo.value||'').trim() : '';
      const params = new URLSearchParams();
      if(a) params.set('from_nr', a);
      if(b) params.set('to_nr', b);
      const s = exSort ? String(exSort.value||'').trim() : '';
      if(s) params.set('sortiment_id', s);

      // Admin Token als Query mitschicken (Server prüft token=...)
      const t = getToken ? String(getToken()||'').trim() : '';
      if(t) params.set('token', t);

      const url = '/api/export.csv' + (params.toString() ? ('?' + params.toString()) : '');
      window.location.href = url;
    });
  }




// Bilder ZIP Export Bereich (Von/Bis)
const btnExportImages = document.getElementById('btn-export-images');
if(btnExportImages){
  btnExportImages.addEventListener('click', ()=>{
    const a = exFrom ? String(exFrom.value||'').trim() : '';
    const b = exTo ? String(exTo.value||'').trim() : '';
    const params = new URLSearchParams();
    if(a) params.set('from_nr', a);
    if(b) params.set('to_nr', b);
    const s = exSort ? String(exSort.value||'').trim() : '';
    if(s) params.set('sortiment_id', s);

    // Admin Token als Query mitschicken (Server prüft token=...)
    const t = getToken ? String(getToken()||'').trim() : '';
    if(t) params.set('token', t);

    const url = '/api/export_images.zip' + (params.toString() ? ('?' + params.toString()) : '');
    window.location.href = url;
  });
}

  // Restore/Import
  const btnRestoreNow = document.getElementById('btn-restore-now');
  const importFile = document.getElementById('import-file');
  const btnImportRun = document.getElementById('btn-import-run');
  const importStatus = document.getElementById('import-status');
  let _importPicked = null;

  if(importFile){
    importFile.addEventListener('change', ()=>{
      _importPicked = (importFile.files && importFile.files[0]) ? importFile.files[0] : null;
      if(importStatus) importStatus.textContent = _importPicked ? ("Ausgewählt: " + _importPicked.name) : "";
    });
  }

  if(btnRestoreNow){
    btnRestoreNow.addEventListener('click', async ()=>{
      try{
        if(importStatus) importStatus.textContent = "Restore läuft …";
        const t = getToken();
        const res = await fetch('/api/admin/restore_now', { method:'POST', headers: { ...(t ? {'X-Admin-Token': t} : {}) } });
        const j = await res.json();
        if(!res.ok || !j.ok){
          if(importStatus) importStatus.textContent = "Restore Fehler: " + (j.error || res.status);
          return;
        }
        if(importStatus) importStatus.textContent = "Restore OK: " + (j.status || "ok");
        await loadSortimente();
        await refresh();
      }catch(e){
        if(importStatus) importStatus.textContent = "Restore Fehler: " + String(e);
      }
    });
  }

  if(btnImportRun){
    btnImportRun.addEventListener('click', async ()=>{
      try{
        if(!_importPicked){
          alert("Bitte zuerst eine CSV auswählen.");
          return;
        }
        if(importStatus) importStatus.textContent = "Import läuft …";
        const t = getToken();
        const fd = new FormData();
        fd.append('file', _importPicked);
        fd.append('overwrite', '0');
        const res = await fetch('/api/admin/import_csv', { method:'POST', headers: { ...(t ? {'X-Admin-Token': t} : {}) }, body: fd });
        const j = await res.json();
        if(!res.ok || !j.ok){
          if(importStatus) importStatus.textContent = "Import Fehler: " + (j.error || res.status);
          return;
        }
        if(importStatus) importStatus.textContent = `Import OK: created=${j.created}, updated=${j.updated}, skipped=${j.skipped}`;
        await loadSortimente();
        await refresh();
      }catch(e){
        if(importStatus) importStatus.textContent = "Import Fehler: " + String(e);
      }
    });
  }

  init();

</script>
</body>
</html>
